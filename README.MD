# üíà Sistema de Citas - Barber King (Backend)

![Java](https://img.shields.io/badge/Java-17-orange?style=for-the-badge&logo=java)
![Spring Boot](https://img.shields.io/badge/Spring_Boot-3.4-brightgreen?style=for-the-badge&logo=springboot)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-14-blue?style=for-the-badge&logo=postgresql)
![Azure](https://img.shields.io/badge/Azure-Cloud-0078D4?style=for-the-badge&logo=microsoftazure)

Plataforma integral para la gesti√≥n y agendamiento de citas, desarrollada bajo **Arquitectura Hexagonal**. El sistema administra sucursales, empleados, servicios y clientes, integrando geolocalizaci√≥n espacial para las sucursales y validaci√≥n estricta de horarios laborales.

**Instituci√≥n:** UPIICSA - Instituto Polit√©cnico Nacional (IPN)  
**Proyecto:** Sistema de Citas (3er Parcial)  
**Materia:** Programaci√≥n Web / Ingenier√≠a en Informatica

---

## üöÄ Caracter√≠sticas Clave

* **Arquitectura Hexagonal:** Desacoplamiento total entre la l√≥gica de negocio (Dominio) y la infraestructura (Base de datos, API REST).
* **Geolocalizaci√≥n (PostGIS):** Almacenamiento y consulta de coordenadas geogr√°ficas para ubicaci√≥n de sucursales.
* **Gesti√≥n de Horarios (Timezone Sensitive):** Sincronizaci√≥n estricta con zona horaria `America/Mexico_City` para evitar conflictos en citas (UTC handling).
* **Seguridad:** Encriptaci√≥n de contrase√±as con SHA-512 y gesti√≥n de roles (Admin, Empleado, Cliente).
* **Despliegue Cloud:** Optimizado para ejecuci√≥n en servidores Linux (Ubuntu) en Microsoft Azure.

---

## üõ†Ô∏è Stack Tecnol√≥gico

* **Lenguaje:** Java 17 (JDK)
* **Framework:** Spring Boot 3.4.12
* **Base de Datos:** PostgreSQL 14 + Extensiones **PostGIS**
* **ORM:** Hibernate Spatial
* **Build Tool:** Maven
* **Utiler√≠as:** Lombok, Jakarta EE

---

## ‚öôÔ∏è Configuraci√≥n de Base de Datos

El proyecto incluye scripts automatizados para entornos locales y de producci√≥n.

### Opci√≥n A: Entorno Local (Desarrollo)
1.  Navega a la carpeta de scripts:
    ```bash
    cd base-datos/scripts/local
    ```
2.  Ejecuta el constructor maestro (requiere cliente `psql`):
    ```bash
    sudo -u postgres psql -f build.sql
    ```

### Opci√≥n B: Producci√≥n (Seed Limpio)
Para restaurar la base de datos a un estado de f√°brica (5 sucursales, 10 empleados, cat√°logos limpios):
```bash
psql -d citas -f base-datos/scripts/local/respaldo_produccion.sql
```

---

## ‚ñ∂Ô∏è Ejecuci√≥n y Despliegue

### 1. Entorno Local (IDE / Terminal)
```bash
mvn spring-boot:run
```

Acceso: `http://localhost:8080`

---

### 2. Producci√≥n (Linux / Azure VM)
Para ejecuci√≥n en segundo plano (Daemon) asegurando la zona horaria correcta:

```bash
nohup java -Duser.timezone=America/Mexico_City -jar target/sistema-citas-0.0.1-SNAPSHOT.jar \
  --spring.datasource.url=jdbc:postgresql://localhost:5432/citas \
  --spring.datasource.username=postgres \
  --spring.datasource.password=TU_PASSWORD > log.txt 2>&1 &
```
---

## üîå Endpoints Principales

| M√©todo | Endpoint | Descripci√≥n |
| :--- | :--- | :--- |
| **POST** | `/api/citas` | Agendar nueva cita (Valida disponibilidad y horario laboral) |
| **GET** | `/api/citas` | Listar citas (Filtros por rol de usuario) |
| **POST** | `/api/sucursales` | Registrar sucursal con punto geogr√°fico (Lat/Lon) |
| **GET** | `/api/servicios` | Cat√°logo de servicios y precios vigentes |
| **POST** | `/api/usuarios/login` | Autenticaci√≥n de usuarios |

---

## ‚úíÔ∏è Autor:

* **Ivan Herrera** - *Desarrollador & DevOps*

---
*Hecho con ‚ù§Ô∏è y mucho caf√© en la CDMX.*
